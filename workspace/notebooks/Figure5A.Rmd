---
title: "HB10hpf neural Cluster Tree R Notebook"
output: github_document
---

# 1. libraries
```{r libraries, results=F}
library(Seurat)
library(Signac)
library(dplyr)
library(ggplot2)
library(ggsci)
options(future.globals.maxSize = 4000 * 1024^2)
```

# 2. Read data
```{r readData}
HB10hpf <- readRDS("RDSfiles/HB10hpf_neural.RDS")
Idents(HB10hpf) <- "Clusters"
DimPlot(HB10hpf, reduction = "wnn.umap") + scale_color_igv()
```

# 3. Build Cluster Tree
```{r BuildTree}
HB10hpf <- BuildClusterTree(HB10hpf, graph = "wsnn")
```

# 4. Plot Cluster Tree

```{r PlotTree, fig.width=5, fig.height=3}
p <- PlotClusterTree(HB10hpf,direction = "rightwards")
p
```

```{r plot, fig.height=7, fig.width=7}
data.tree <- Tool(object = HB10hpf, slot = "BuildClusterTree")
png(filename = "../results/Fig5A_HB10hpf_clustertree_unrooted.png",width = 800, height = 800)
p1 <- ape::plot.phylo(x = data.tree,  use.edge.length = FALSE, cex = 0.7, type = "u")
p1
dev.off()
```

```{r sessionInfo}
sessionInfo()
```

