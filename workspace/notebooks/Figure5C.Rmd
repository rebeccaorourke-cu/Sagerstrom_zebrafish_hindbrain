---
title: "HB16hpf neural Cluster Tree R Notebook"
output: github_document
---

# 1. libraries
```{r libraries, results=F}
library(Seurat)
library(Signac)
library(dplyr)
library(ggplot2)
library(ggsci)
options(future.globals.maxSize = 4000 * 1024^2)
```

# 2. Read data
```{r readData}
HB16hpf <- readRDS("RDSfiles/HB16hpf_neural.RDS")
Idents(HB16hpf) <- "Clusters"
DimPlot(HB16hpf, reduction = "wnn.umap") + scale_color_igv()
```

# 3. Build Cluster Tree
```{r BuildTree}
HB16hpf <- BuildClusterTree(HB16hpf, graph = "wsnn")
```

# 4. Plot Cluster Tree
```{r PlotTree, fig.width=5, fig.height=3}
p <- PlotClusterTree(HB16hpf,direction = "rightwards")
p
```

```{r plot, fig.height=7, fig.width=7}
data.tree <- Tool(object = HB16hpf, slot = "BuildClusterTree")
png(filename = "../results/Fig5C_HB16hpf_clustertree_unrooted.png",width = 900, height = 900)
p1 <- ape::plot.phylo(x = data.tree,  use.edge.length = FALSE, type = "u")
p1
dev.off()
```

```{r sessionInfo}
sessionInfo()
```

